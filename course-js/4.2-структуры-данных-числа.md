# Структуры данных

Все значения в JS, за исключением `null` и `undefined`, содержат набор вспомогательных функций и значений, доступных через точку.
Такие функции называют "методами", а значения – "свойствами".

## Числа

В JS числа можно записывать в десятичной и шестнадцатеричной форме, а также в научном формате:
```
alert( 0xFF ); // 255 в шестнадцатиричной системе (начинается с 0x)
alert( 3e5 );  // 300000 (<число>e<количество нулей>)
alert( 3e-5 ); // 0.00003
```

### Infinity
В JS (в отличии от других языков) можно выразить или получить при мат. операциях бесконечность.
`Infinity` – численное значение, определяющее бесконечность "∞".
Может быть отрицательной (`-Infinity`).
```
var x = Infinity;
1 / 0;     // Infinity
12345 / 0; // Infinity
-1 / 0;    // -Infinity
```

**НЮАНС**
Бесконечность можно получить также, если сделать большое число, для которого количество разрядов в двоичном представлении не помещается в соответствующую часть стандартного 64-битного формата
```
1e500; // Infinity
```

### NaN (Not a Number)
Никакие математические операции в JS не могут привести к ошибке или "обрушить"" программу.
В худшем случае результат будет `NaN`.

Значение `NaN` используется для обозначения математической ошибки.
`NaN` возвращается если математическая операция не может быть совершена.
```
0 / 0; // NaN
```

Свойства `NaN`:
- не равно ничему, включая себя
- любая операция с `NaN` возвращает `NaN`
```
NaN == NaN  // false
NaN === NaN // false
```

### Функция `isNaN(n)`
Прорверяет строку или число на `NaN`.
Преобразует аргумент к числу и возвращает `true`, если получилось `NaN`, и `false` – для любого другого значения.
```
isNaN( 0/0 );  // true
isNaN( 10 );  // false
isNaN( '12' ); // false, строка преобразовалась к обычному числу 12
```

Особенности (вернется `false`, значит не `NaN`):
- пустая строка и строка из пробельных символов преобразуются к 0
- `false`, `true`, `null` - преобразуются к числам (0, 1, 0 соответственно)
```
isNaN( '\n  \n' ); // false
isNaN( null );     // false
```

### Функция `isFinite(n)`
По сути, проверка на конечность числа.
Преобразует аргумент к числу и возвращает `true`, если это не `NaN` или `Infinity`.
```
isFinite( 1 );        // true
isFinite( Infinity ); // false
isFinite( NaN );      // false
```

### Продвинутые функции преобразования к числу `parseInt(n)` и `parseFloat(n)`
Преобразуют строку символ за символом, пока это возможно (до первой ошибки).
`parseInt` - пытается прочесть из строки целое число.
`parseFloat` - пытается прочесть из строки десятичное число.
Они возвращают `NaN` при ошибке на первом же символе.
```
parseInt( '12px' );     // 12 - ошибка на символе 'p'
parseFloat( '12.3.4' ); // 12.3 - ошибка на второй точке
parseInt( '12.3.4' );   // 12 - ошибка на первой точке
parseInt( 'a123' );     // NaN
```

`parseInt` также позволяет указать систему счисления
```
alert( parseInt('FF', 16) ); // 255
```

### Метод числа
К методу числа можно обратиться напрямую: `12.34.toFixed( 1 ); //12.3`
Но если число целое, то будет ошибка потому, что JS ожидает десятичную дробь после точки: `12.toFixed( 1 ); //error`
Это – особенность синтаксиса, с дополнительной точкой – будет работать: `12..toFixed( 1 ); //12.0`

### Метод `.toString()`
Этот метод используется для представления числа в виде строки с учетом другой системы исчисления (систему исчисления смотреть на википедии).
В качестве аргумента принимает основание системы исчисления (от 2 до 36, 16-шестнадцатиричная, 2-двоичная)
```
255..toString(16); // ff (цветовые значения в браузере, например #f1f2f3 - HEX color)
```
**Заметка**
Основание 36 - по количеству букв в английском алфавите – 26, вместе с цифрами, которых 10.
В этой системе счисления сначала используются цифры, а затем буквы от a до z.
```
alert( 1234567890.toString(36) ); // kf12oi
```
При помощи такого кодирования можно «укоротить» длинный цифровой идентификатор, например чтобы выдать его в качестве URL.
(id соцсетей, данные товара и т.д.)

### Округление
В JS существуют 3 функции для округления до целого числа (библиотека `Math`, о ней позже)
- `Math.floor` округляет вниз
- `Math.ceil` округляет вверх
- `Math.round` округляет до ближайшего целого
```
Math.floor( 3.1 );  // 3
Math.ceil( 3.1 );   // 4
Math.round( 3.1 );  // 3
```

**Заметка**
Дополнительный простой способ округления к целому числу это двойное битовое НЕ.
Применяется в основном для сокращения записи в линейных матетматических вычислениях.
```
alert( ~~12.3 ); // 12
```

Для округления до нужной точности можно использовать математические операции
```
var n = 3.456;               // Например до 2-х знаков после запятой
Math.round( n * 100 ) / 100; // 3.456 -> 345.6 -> 346 -> 3.46
```

### Метод `.toFixed()`
Это специальный метод, который округляет число до заданной точности и возвращает результат в виде строки.
В качестве аргумента принимает точность в виде числа представляющего колличество символов после запятой.
Округление идёт до ближайшего значения, аналогично `Math.round`.
Итоговая строка, при необходимости, дополняется нулями до нужной точности.
```
12.34.toFixed( 1 ); // '12.3'
12.35.toFixed( 1 ); // '12.4'
12.34.toFixed( 5 ); // '12.34000'
```

**НЮАНС**
Метод `.toFixed` не эквивалентен `Math.round` из за неточностей вычисления в JS (о них ниже).
```
6.35.toFixed( 1 );            // 6.3
Math.round( 6.35 * 10 ) / 10; // 6.4 - Math.round более корректный
```

### Неточности вычисления JS
В JS на число выделяется ровно 8 байт (64 бита) (стандарт IEEE 754).

Число 0.1 (одна десятая в десятичной системе) в двоичной системе счисления это бесконечная дробь, так как единица на десять в двоичной системе не делится.
Также бесконечной дробью является 0.2 (=2/10).
Двоичное значение бесконечных дробей хранится только до определенного знака, поэтому возникает неточность.
```
0.1.toFixed( 20 ); // 0.10000000000000000555
```
Есть два способа учитывать такие неточности:
1. Сделать их целыми, сложить, а потом поделить.
Это работает, так как числа `0.1*10 = 1` и `0.2*10 = 2` могут быть точно представлены в двоичной системе
```
(0.1 * 10 + 0.2 * 10) / 10; // 0.3
```
2. Округлить до разумного знака после запятой
Округления до 10-го знака обычно бывает достаточно.
```
var result = 0.1 + 0.2;
alert( +result.toFixed( 10 ) ); // 0.3
```
Ошибка в точности вычислений для чисел с плавающей точкой сохраняется в любом другом языке, где используется формат IEEE 754,
включая Java, C, PHP, Ruby, Perl, Python.

### Другие математические операции
Тригонометрия:
- `Math.acos( x )`     возвращает арккосинус x (в радианах)
- `Math.asin( x )`     возвращает арксинус x (в радианах)
- `Math.atan( x )`     возвращает арктангенс x (в радианах)
- `Math.atan2( y, x )` возвращает угол до точки (y, x). Описание функции: Atan2.
- `Math.sin( x )`      вычисляет синус x
- `Math.cos( x )`      вычисляет косинус x
- `Math.tan( x )`      возвращает тангенс x

Функции общего назначения:
- `Math.sqrt( x )`        возвращает квадратный корень из x.
- `Math.log( x )`         возвращает натуральный (по основанию e) логарифм x.
- `Math.pow( x, exp )`    возводит число в степень
- `Math.abs( x )`         возвращает абсолютное значение числа
- `Math.exp( x )`         возвращает e^x, где e – основание натуральных логарифмов.
- `Math.max( a, b, c.. )` возвращает наибольший из списка аргументов
- `Math.min( a, b, c.. )` возвращает наименьший из списка аргументов
- `Math.random()`         возвращает псевдослучайное число в интервале [0,1]

### Форматирование
Для красивого вывода чисел в стандарте ECMA 402 есть метод `.toLocaleString()`
```
var number = 123456789;
alert( number.toLocaleString() ); // 123 456 789
```


# Д.З.
Полностью прочесть пункты и выполнить из них все задачи:
- [Введение в методы и свойства](http://learn.javascript.ru/properties-and-methods);
- [Числа](http://learn.javascript.ru/number).
